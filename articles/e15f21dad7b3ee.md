---
title: "PlanetScaleã§ã¯`prisma migrate`ã¯ä½¿ã‚ãªã„"
emoji: "ğŸŒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["planetscale", "prisma"]
published: true
publication_name: "praha"
---

å€‹äººé–‹ç™ºã§PlanetScaleã¨Prismaã‚’ä½¿ç”¨ã—ã¦ã„ã¦ã€ã“ã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ä¸Šã§èª¿ã¹ãŸã“ã¨ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

## TL;DR

- PlanetScaleã¨Prismaã‚’ä½µç”¨ã™ã‚‹å ´åˆã€ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã¯PlanetScaleã«ä»»ã›ã‚‹
- `prisma migrate`ã¯ä½¿ã‚ãšã€`prisma db push`ã‚’ä½¿ã†

## PlanetScaleã¨Prismaã«ã¤ã„ã¦

PlanetScaleã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚åˆ©ç”¨æ–™é‡‘ã®ç„¡æ–™æ ã§ã§ãã‚‹ã“ã¨ãŒå……å®Ÿã—ã¦ã„ã‚‹ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãŒé«˜ã„ã€ãªã©ã®ç†ç”±ã§æ³¨ç›®ã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚å€‹äººçš„ã«ã¯ã€å€‹äººé–‹ç™ºã«ãŠã‘ã‚‹ã€ŒRDBã®ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„ã€ã€Œã‘ã©ãƒã‚ºã£ãŸã¨ãã‚‚ã¡ã‚ƒã‚“ã¨å¯¾å¿œã—ãŸã„ã€ã¨ã„ã†ä¸å®‰ã‚’è§£æ¶ˆã§ããã†ãªã‚µãƒ¼ãƒ“ã‚¹ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

Prismaã¯ã€Node.jsã¨TypeScriptã®ãŸã‚ã®ORMã§ã™ã€‚å®£è¨€çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã€ŒPrisma Migrateã€ã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ŒPrisma Clientã€ãªã©ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¢ãƒ‡ãƒ«ã®å‹ãŒä¸€è‡´ã™ã‚‹ã“ã¨ã§ã€å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã‚’TypeScriptã§é–‹ç™ºã™ã‚‹ã®ã§ã‚ã‚Œã°ã€PlanetScaleã¨Prismaã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã“ã¨ã§ã€éå¸¸ã«è‰¯ã„é–‹ç™ºè€…ä½“é¨“ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€PlanetScaleã¨Prismaã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã¨ãã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚

## ãã‚Œãã‚Œã®ã‚¹ã‚­ãƒ¼ãƒãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿

PlanetScaleã¨Prismaã¯ã€ãã‚Œãã‚Œåˆ¥ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã®ä»•çµ„ã¿ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

### PlanetScaleã®Branching

PlanetScaleã§ã¯[Branching](https://planetscale.com/docs/concepts/branching)ã¨ã„ã†æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ã§ã€gitã®ãƒ–ãƒ©ãƒ³ãƒæ©Ÿèƒ½ã«è¿‘ã„æ„Ÿè¦šã§ã€ã€Œãƒ–ãƒ©ãƒ³ãƒã€ã‚’ä½œã£ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’åˆ†å²ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æœ¬ç•ªç”¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã§ä½œæ¥­ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚

1. æœ¬ç•ªãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ã€Œdevelopment branchã€ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®ãƒ–ãƒ©ãƒ³ãƒä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã€æœ¬ç•ªDBã¨åŒæ§˜ã®ã‚¹ã‚­ãƒ¼ãƒã‚’æŒã£ãŸåˆ¥ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãªã®ã§ã€è‡ªç”±ã«å¤‰æ›´ã‚’åŠ ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
2. development branchä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã€ã‚«ãƒ©ãƒ ã®å‰Šé™¤ã‚„ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¿½åŠ ãªã©ã®ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´ã‚’è¡Œã„ã¾ã™ã€‚
3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã‹ã‚‰development branchä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã—ã€å•é¡Œãªãå‹•ä½œã™ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
4. ã€Œdeploy requestã€ã‚’ä½œæˆã—ã¾ã™ã€‚
5. PlanetScaleã¯ã€deploy requestã®é–‹ç™ºã‚¹ã‚­ãƒ¼ãƒã¨æœ¬ç•ªã‚¹ã‚­ãƒ¼ãƒã¨ã‚’æ¯”è¼ƒã—ã¦ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã©ã®ã‚ˆã†ãªå¤‰æ›´ãŒè¡Œã‚ã‚Œã‚‹ã‹ã€ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ãªè¦æ±‚ã‹ã©ã†ã‹ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼ãŒæ¬ è½ã—ã¦ã„ãªã„ã‹ã€ãªã©ã®ã‚¹ã‚­ãƒ¼ãƒã®å•é¡Œç‚¹ãŒãªã„ã‹ã©ã†ã‹ãªã©ï¼‰ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
6. é–‹ç™ºãƒãƒ¼ãƒ ã¯deploy requestã‚’ç¢ºèªã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æ‰¿èªã—ã¾ã™ã€‚
7. PlanetScaleãŒæ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤é–‹å§‹ã—ã¾ã™ã€‚
8. ã“ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒã‚¼ãƒ­ã«ãªã‚‹ã‚ˆã†ãªæ–¹æ³•ã§å®Ÿæ–½ã•ã‚Œã‚‹ãŸã‚ã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚ŒãŸã‚Šã€ç§»è¡Œä¸­ã«æœ¬ç•ªç’°å¢ƒãŒé…ããªã‚‹ãªã©ã®å•é¡ŒãŒèµ·ã“ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

![PlanetScaleã®Blanchingã®ã‚¤ãƒ¡ãƒ¼ã‚¸å›³](https://planetscale-images.imgix.net/docs/concepts/branching/diagram.png?auto=compress%2Cformat)

è©³ç´°ã¯[ã“ã¡ã‚‰](https://planetscale.com/docs/concepts/branching)ã€‚

### Prismaã®Prisma Migrate

[Prisma Migrate](https://www.prisma.io/docs/concepts/components/prisma-migrate)ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®çŠ¶æ…‹ã‚’è¿½è·¡ã™ã‚‹ãŸã‚ã«æ¬¡ã®æƒ…å ±ã‚’ä½¿ã„ã¾ã™

- **prismaã®ã‚¹ã‚­ãƒ¼ãƒ** â€¦ `schema.prisma`ã®ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®æ§‹é€ ã‚’å®šç¾©ã™ã‚‹source of truthã§ã™ã€‚
- **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´** â€¦ `prisma/migrations`ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã‚ã‚‹SQLãƒ•ã‚¡ã‚¤ãƒ«ã®ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´å±¥æ­´ã‚’è¡¨ã—ã¾ã™ã€‚
- **`prisma_migrations`ãƒ†ãƒ¼ãƒ–ãƒ«** â€¦ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚ã‚‹`prisma_migrations`ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é©ç”¨ã•ã‚ŒãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã—ã¾ã™ã€‚
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ** â€¦ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®Ÿéš›ã®çŠ¶æ…‹ã®ã“ã¨ã§ã™ã€‚

æœ¬ç•ªç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã§ä½œæ¥­ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚

1. prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚’æ›´æ–°ã—ã¾ã™ã€‚
2. `prisma migrate dev`ã‚‚ã—ãã¯`prisma db push`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
3. `prisma migrate dev`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸå ´åˆã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ã¨`prisma_migrations`ãƒ†ãƒ¼ãƒ–ãƒ«ãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚
4. ãŸã¨ãˆã°GitHubã§ã‚³ãƒ¼ãƒ‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚’è¡Œã£ã¦ã„ã‚‹å ´åˆã€prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ãªã©ã®å¤‰æ›´ã®ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
5. GitHub Actionsãªã©ã®CIã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ©ç”¨ã—ã¦ã€ã‚¹ã‚­ãƒ¼ãƒç­‰ã®å¤‰æ›´ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã€`prisma migrate deploy`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
6. `prisma migrate deploy`ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚Šã€prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ã‹ã‚‰ã€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚
7. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒãƒ¼ã‚¸ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã—ã¦ã€CIã‚·ã‚¹ãƒ†ãƒ ã§`prisma migrate deploy`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™
8. `prisma migrate deploy`ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚Šã€prismaã®ã‚¹ã‚­ãƒ¼ãƒã‚„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ã‹ã‚‰ã€æœ¬ç•ªç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚

![Prismaã®Prisma Migrateã®ã‚¤ãƒ¡ãƒ¼ã‚¸å›³](https://www.prisma.io/docs/static/19181e590d4e9235f167f8ab7422a6c8/663f3/prisma-migrate-lifecycle.png)

è©³ç´°ã¯[ã“ã¡ã‚‰](https://www.prisma.io/docs/concepts/components/prisma-migrate/mental-model#what-is-prisma-migrate)

## Prismaã§PlanetScaleã®DBã‚¹ã‚­ãƒ¼ãƒã‚’å¤‰æ›´ã™ã‚‹ã«ã¯

PlanetScaleã¯é–‹ç™ºãƒ–ãƒ©ãƒ³ãƒã‚’æœ¬ç•ªãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã™ã‚‹ã¨ãè‡ªå‹•çš„ã«ç‹¬è‡ªã®ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†ã‚’ç”Ÿæˆã—ã€ç‹¬è‡ªã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚Prismaã¯SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚„`prisma_migrations`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ã£ã¦ç‹¬è‡ªã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚

PrismaãŒç®¡ç†ã™ã‚‹SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚„`prisma_migrations`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ã€PlanetScaleãŒç”Ÿæˆã™ã‚‹ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†ã®æƒ…å ±ã¯åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚ã¾ãŸã€PlanetScaleãŒç”Ÿæˆã™ã‚‹ã‚¹ã‚­ãƒ¼ãƒå·®åˆ†ã«ã‚‚PrismaãŒç®¡ç†ã™ã‚‹SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚„`prisma_migrations`ãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šã€PlanetScaleã‚‚Prismaã‚‚ãã‚Œãã‚Œç‹¬è‡ªã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ç®¡ç†æ–¹æ³•ã‚’æŒã£ã¦ã„ã‚‹ãŸã‚ã€ãã‚Œã‚‰ã‚’ä¸¡ç«‹ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

Prismaã¯ã€**PlanetScaleã§ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´ã‚’è¡Œã†å ´åˆã¯`prisma migrate`ã‚’ä½¿ç”¨ã›ãšã€`prisma db push`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹**ã“ã¨ã‚’[æ¨å¥¨ã—ã¦ã„ã¾ã™](https://www.prisma.io/docs/guides/database/using-prisma-with-planetscale#:~:text=Prisma%20recommends%20not%20using%20prisma%20migrate%20when%20making%20schema%20changes%20with%20PlanetScale.%20Instead%2C%20we%20recommend%20that%20you%20use%20the%20prisma%20db%20push%20command.)ã€‚

PlanetScaleã‚‚ã€**ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã«ã¤ãªãŒã‚‹ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã‚’é˜²æ­¢ã—ã¤ã¤å¤‰æ›´ã‚’é©ç”¨ã™ã‚‹è²¬ä»»ã¯PlanetScaleå´ã«ã‚ã‚Šã€PlanetScaleã¨ã„ã£ã—ã‚‡ã«`prisma migrate`ã‚’ä½¿ç”¨ã™ã‚‹ä¾¡å€¤ã¯ã»ã¨ã‚“ã©ãªã„**ã¨ã—ã€`prisma db push`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’[æ¨å¥¨ã—ã¦ã„ã¾ã™](https://planetscale.com/docs/tutorials/automatic-prisma-migrations#:~:text=We%20recommend%20prisma%20db%20push%20over%20prisma%20migrate%20dev%20for%20the%20following%20reasons%3A)ã€‚

### æ‰‹é †

PlanetScaleã§`prisma db push`ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€Prisma Clientã§å‚ç…§ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚PlanetScaleã§ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã§å¤–éƒ¨ã‚­ãƒ¼ãŒåˆ©ç”¨ã§ããšã€ãã‚ŒãŒé–¢ä¿‚ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

> To use db push with PlanetScale, you will first need to enable emulation of relations in Prisma Client. Pushing to your branch without referential emulation enabled will give the error message Foreign keys cannot be created on this database.

<https://www.prisma.io/docs/guides/database/using-prisma-with-planetscale#how-to-make-schema-changes-with-db-push>

<!-- TODO: https://www.prisma.io/docs/guides/database/using-prisma-with-planetscale -->

```plaintext
datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}
```

`schema.prisma`ã®`relationMode`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’`prisma`ã«è¨­å®šã™ã‚‹ã“ã¨ã§å‚ç…§ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–ã§ãã¾ã™ã€‚

ã‚ã¨ã¯ã€`schema.prisma`ã«å®šç¾©ã—ã¦ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’å¤‰æ›´ã—ã€`prisma db push`ã€PlanetScaleã§ãƒ‡ãƒ—ãƒ­ã‚¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã—ã¦ãƒãƒ¼ã‚¸ã™ã‚‹ã ã‘ã§ã™ã€‚ã‚‚ã£ã¨è©³ã—ã„æ‰‹é †ãŒçŸ¥ã‚ŠãŸã„æ–¹ã¯ã€ä¸‹è¨˜ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## å‚è€ƒ

<https://planetscale.com/docs/concepts/branching>
<https://www.prisma.io/docs/concepts/components/prisma-migrate/mental-model#what-is-prisma-migrate>
<https://www.prisma.io/docs/guides/database/using-prisma-with-planetscale>
<https://planetscale.com/docs/tutorials/automatic-prisma-migrations>
